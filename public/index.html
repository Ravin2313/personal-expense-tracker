<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Expense Tracker - Galaxy Theme</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Animated Particles -->
    <div class="particles" id="particles"></div>
    
    <!-- Budget Alert Notifications -->
    <div id="budget-alerts-container" class="budget-alerts-container"></div>
    
    <div id="app">
        <!-- Auth Section -->
        <div id="auth-section" class="container">
            <div class="auth-box">
                <h1>Expense Tracker</h1>
                <div class="tabs">
                    <button class="tab-btn active" onclick="showLogin()">Login</button>
                    <button class="tab-btn" onclick="showRegister()">Register</button>
                </div>
                
                <!-- Login Form -->
                <form id="login-form" class="auth-form">
                    <input type="email" id="login-email" placeholder="Email" required>
                    <input type="password" id="login-password" placeholder="Password" required>
                    <button type="submit">Login</button>
                </form>

                <!-- Register Form -->
                <form id="register-form" class="auth-form" style="display: none;">
                    <input type="text" id="register-name" placeholder="Name" required>
                    <input type="email" id="register-email" placeholder="Email" required>
                    <input type="password" id="register-password" placeholder="Password" required>
                    <button type="submit">Register</button>
                </form>
            </div>
        </div>

        <!-- Main App Section -->
        <div id="main-section" style="display: none;">
            <nav class="navbar navbar-expand-lg">
                <div class="container-fluid">
                    <h2 class="navbar-brand mb-0">Expense Tracker</h2>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarNav">
                        <ul class="navbar-nav ms-auto align-items-lg-center">
                            <li class="nav-item">
                                <a href="index.html" class="nav-link active">
                                    <i class="bi bi-speedometer2 me-1"></i>Dashboard
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="analytics.html" class="nav-link">
                                    <i class="bi bi-graph-up me-1"></i>Analytics
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="friends.html" class="nav-link">
                                    <i class="bi bi-people me-1"></i>Friends
                                </a>
                            </li>
                            <li class="nav-item">
                                <span class="nav-link" id="user-name">
                                    <i class="bi bi-person-circle me-1"></i>
                                </span>
                            </li>
                            <li class="nav-item">
                                <button class="btn-logout" onclick="logout()">
                                    <i class="bi bi-box-arrow-right me-1"></i>Logout
                                </button>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>

            <div class="container">
                <div class="dashboard">
                    <!-- Stats Cards -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3>Total Income</h3>
                            <p class="stat-value" id="total-income" style="color: var(--success);">₹0</p>
                        </div>
                        <div class="stat-card">
                            <h3>Total Expenses</h3>
                            <p class="stat-value" id="total-expenses" style="color: var(--danger);">₹0</p>
                        </div>
                        <div class="stat-card">
                            <h3>Net Savings</h3>
                            <p class="stat-value" id="net-savings">₹0</p>
                        </div>
                        <div class="stat-card stat-card-budget">
                            <div class="budget-header">
                                <h3>Budget Left</h3>
                                <button class="btn-set-budget" id="open-budget-btn" type="button">
                                    <i class="bi bi-gear"></i>
                                </button>
                            </div>
                            <p class="stat-value" id="budget-left">₹0</p>
                            <div class="budget-progress">
                                <div class="budget-progress-bar" id="budget-progress-bar"></div>
                            </div>
                            <p class="budget-info" id="budget-info">Click gear to set budget</p>
                        </div>
                    </div>

                    <!-- Add Expense Form -->
                    <div class="card expense-card">
                        <div class="card-header-custom">
                            <h3><i class="bi bi-receipt"></i> Add Expense</h3>
                            <span class="card-badge danger">Track Your Spending</span>
                        </div>
                        <form id="expense-form" class="modern-form">
                            <div class="form-row">
                                <div class="input-group-modern">
                                    <label class="input-label"><i class="bi bi-currency-rupee"></i> Amount</label>
                                    <input type="number" id="amount" placeholder="Enter amount" required class="modern-input">
                                    <span class="input-focus-border"></span>
                                </div>
                                <div class="input-group-modern">
                                    <label class="input-label"><i class="bi bi-grid"></i> Category</label>
                                    <select id="category" required class="modern-input">
                                        <option value="">Select Category</option>
                                    </select>
                                    <span class="input-focus-border"></span>
                                </div>
                            </div>
                            <div class="input-group-modern">
                                <label class="input-label"><i class="bi bi-chat-left-text"></i> Description</label>
                                <input type="text" id="description" placeholder="What did you spend on?" class="modern-input">
                                <span class="input-focus-border"></span>
                            </div>
                            <div class="form-row">
                                <div class="input-group-modern">
                                    <label class="input-label"><i class="bi bi-calendar-event"></i> Date</label>
                                    <input type="date" id="date" required class="modern-input">
                                    <span class="input-focus-border"></span>
                                </div>
                                <div class="input-group-modern">
                                    <label class="input-label"><i class="bi bi-credit-card"></i> Payment Method</label>
                                    <select id="payment-method" class="modern-input">
                                        <option value="Cash">Cash</option>
                                        <option value="Card">Card</option>
                                        <option value="UPI">UPI</option>
                                        <option value="Net Banking">Net Banking</option>
                                    </select>
                                    <span class="input-focus-border"></span>
                                </div>
                            </div>
                            <div class="input-group-modern">
                                <label class="input-label"><i class="bi bi-image"></i> Receipt (Optional)</label>
                                <input type="file" id="receipt" accept="image/*" class="modern-input file-input">
                                <span class="input-focus-border"></span>
                            </div>
                            
                            <!-- Split Option -->
                            <div class="split-checkbox-container" onclick="toggleSplitOptions()">
                                <input type="checkbox" id="split-expense" onclick="event.stopPropagation(); toggleSplitOptions()">
                                <label for="split-expense"><i class="bi bi-people"></i> Split with friend</label>
                            </div>
                            
                            <div class="split-options" id="split-options">
                                <div class="form-group">
                                    <label>Select Friend</label>
                                    <select id="split-friend">
                                        <option value="">Select friend...</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Split Type</label>
                                    <select id="split-type" onchange="updateSplitAmounts()">
                                        <option value="equal">Equal Split (50-50)</option>
                                        <option value="custom">Custom Split</option>
                                        <option value="full">I paid full (Friend owes all)</option>
                                    </select>
                                </div>
                                <div class="form-row" id="custom-split" style="display: none;">
                                    <div class="form-group">
                                        <label>Your Share</label>
                                        <input type="number" id="your-share" placeholder="Your amount">
                                    </div>
                                    <div class="form-group">
                                        <label>Friend's Share</label>
                                        <input type="number" id="friend-share" placeholder="Friend's amount">
                                    </div>
                                </div>
                            </div>
                            
                            <button type="submit" class="btn-modern btn-danger">
                                <i class="bi bi-plus-circle-fill"></i> Add Expense
                                <span class="btn-shine"></span>
                            </button>
                        </form>
                    </div>

                    <!-- Add Income Form -->
                    <div class="card income-card">
                        <div class="card-header-custom">
                            <h3><i class="bi bi-wallet2"></i> Add Income</h3>
                            <span class="card-badge success">Track Your Earnings</span>
                        </div>
                        <form id="income-form" class="modern-form">
                            <div class="form-row">
                                <div class="input-group-modern">
                                    <label class="input-label"><i class="bi bi-currency-rupee"></i> Amount</label>
                                    <input type="number" id="income-amount" placeholder="Enter amount" required class="modern-input">
                                    <span class="input-focus-border"></span>
                                </div>
                                <div class="input-group-modern">
                                    <label class="input-label"><i class="bi bi-tag"></i> Source</label>
                                    <input type="text" id="income-source" placeholder="e.g., Ghar se, Pocket Money, Freelance" required class="modern-input">
                                    <span class="input-focus-border"></span>
                                </div>
                            </div>
                            <div class="input-group-modern">
                                <label class="input-label"><i class="bi bi-chat-left-text"></i> Description (Optional)</label>
                                <input type="text" id="income-description" placeholder="Add a note about this income" class="modern-input">
                                <span class="input-focus-border"></span>
                            </div>
                            <div class="input-group-modern">
                                <label class="input-label"><i class="bi bi-calendar-event"></i> Date</label>
                                <input type="date" id="income-date" required class="modern-input">
                                <span class="input-focus-border"></span>
                            </div>
                            <button type="submit" class="btn-modern btn-success">
                                <i class="bi bi-plus-circle-fill"></i> Add Income
                                <span class="btn-shine"></span>
                            </button>
                        </form>
                    </div>

                    <!-- Expenses List -->
                    <div class="card">
                        <div class="card-header-custom">
                            <h3><i class="bi bi-receipt"></i> Recent Expenses</h3>
                            <span class="card-badge danger" id="expense-count">0 entries</span>
                        </div>
                        
                        <!-- Search & Filter Section -->
                        <div class="search-filter-section">
                            <div class="search-box">
                                <i class="bi bi-search"></i>
                                <input type="text" id="search-input" placeholder="Search by description or amount...">
                            </div>
                            
                            <button class="btn-filter" type="button" data-bs-toggle="collapse" data-bs-target="#filterCollapse">
                                <i class="bi bi-funnel"></i> Filters
                            </button>
                            
                            <button class="btn-clear-filter" onclick="clearFilters()">
                                <i class="bi bi-x-circle"></i> Clear
                            </button>
                        </div>

                        <!-- Filter Options (Collapsible) -->
                        <div class="collapse" id="filterCollapse">
                            <div class="filter-options">
                                <div class="filter-row">
                                    <div class="filter-item">
                                        <label><i class="bi bi-tag"></i> Category</label>
                                        <select id="filter-category">
                                            <option value="">All Categories</option>
                                        </select>
                                    </div>
                                    
                                    <div class="filter-item">
                                        <label><i class="bi bi-credit-card"></i> Payment Method</label>
                                        <select id="filter-payment">
                                            <option value="">All Methods</option>
                                            <option value="Cash">Cash</option>
                                            <option value="Card">Card</option>
                                            <option value="UPI">UPI</option>
                                            <option value="Net Banking">Net Banking</option>
                                            <option value="Other">Other</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="filter-row">
                                    <div class="filter-item">
                                        <label><i class="bi bi-calendar"></i> From Date</label>
                                        <input type="date" id="filter-date-from">
                                    </div>
                                    
                                    <div class="filter-item">
                                        <label><i class="bi bi-calendar-check"></i> To Date</label>
                                        <input type="date" id="filter-date-to">
                                    </div>
                                </div>
                                
                                <div class="filter-row">
                                    <div class="filter-item">
                                        <label><i class="bi bi-currency-rupee"></i> Min Amount</label>
                                        <input type="number" id="filter-amount-min" placeholder="Min">
                                    </div>
                                    
                                    <div class="filter-item">
                                        <label><i class="bi bi-currency-rupee"></i> Max Amount</label>
                                        <input type="number" id="filter-amount-max" placeholder="Max">
                                    </div>
                                </div>
                                
                                <button class="btn-apply-filter" onclick="applyFilters()">
                                    <i class="bi bi-check-circle"></i> Apply Filters
                                </button>
                            </div>
                        </div>

                        <!-- Results Count -->
                        <div class="results-info">
                            <span id="results-count">Showing all expenses</span>
                        </div>

                        <div id="expenses-list"></div>
                    </div>

                    <!-- Income List -->
                    <div class="card">
                        <div class="card-header-custom">
                            <h3><i class="bi bi-wallet2"></i> Recent Income</h3>
                            <span class="card-badge success" id="income-count">0 entries</span>
                        </div>
                        <div id="income-list"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Edit Modal -->
        <div id="edit-modal" class="modal">
            <div class="modal-content modern-modal">
                <div class="modal-header">
                    <h3><i class="bi bi-pencil-square"></i> Edit Expense</h3>
                    <span class="close" onclick="closeEditModal()">&times;</span>
                </div>
                <form id="edit-expense-form" class="modern-form">
                    <input type="hidden" id="edit-expense-id">
                    <div class="form-row">
                        <div class="input-group-modern">
                            <label class="input-label"><i class="bi bi-currency-rupee"></i> Amount</label>
                            <input type="number" id="edit-amount" placeholder="Amount" required class="modern-input">
                            <span class="input-focus-border"></span>
                        </div>
                        <div class="input-group-modern">
                            <label class="input-label"><i class="bi bi-grid"></i> Category</label>
                            <select id="edit-category" required class="modern-input">
                                <option value="">Select Category</option>
                            </select>
                            <span class="input-focus-border"></span>
                        </div>
                    </div>
                    <div class="input-group-modern">
                        <label class="input-label"><i class="bi bi-chat-left-text"></i> Description</label>
                        <input type="text" id="edit-description" placeholder="Description" class="modern-input">
                        <span class="input-focus-border"></span>
                    </div>
                    <div class="form-row">
                        <div class="input-group-modern">
                            <label class="input-label"><i class="bi bi-calendar-event"></i> Date</label>
                            <input type="date" id="edit-date" required class="modern-input">
                            <span class="input-focus-border"></span>
                        </div>
                        <div class="input-group-modern">
                            <label class="input-label"><i class="bi bi-credit-card"></i> Payment Method</label>
                            <select id="edit-payment-method" class="modern-input">
                                <option value="Cash">Cash</option>
                                <option value="Card">Card</option>
                                <option value="UPI">UPI</option>
                                <option value="Net Banking">Net Banking</option>
                            </select>
                            <span class="input-focus-border"></span>
                        </div>
                    </div>
                    <button type="submit" class="btn-modern btn-danger">
                        <i class="bi bi-check-circle-fill"></i> Update Expense
                    </button>
                </form>
            </div>
        </div>

        <!-- Edit Income Modal -->
        <div id="edit-income-modal" class="modal">
            <div class="modal-content modern-modal">
                <div class="modal-header">
                    <h3><i class="bi bi-pencil-square"></i> Edit Income</h3>
                    <span class="close" onclick="closeEditIncomeModal()">&times;</span>
                </div>
                <form id="edit-income-form" class="modern-form">
                    <input type="hidden" id="edit-income-id">
                    <div class="form-row">
                        <div class="input-group-modern">
                            <label class="input-label"><i class="bi bi-currency-rupee"></i> Amount</label>
                            <input type="number" id="edit-income-amount" placeholder="Enter amount" required class="modern-input">
                            <span class="input-focus-border"></span>
                        </div>
                        <div class="input-group-modern">
                            <label class="input-label"><i class="bi bi-tag"></i> Source</label>
                            <input type="text" id="edit-income-source" placeholder="Source" required class="modern-input">
                            <span class="input-focus-border"></span>
                        </div>
                    </div>
                    <div class="input-group-modern">
                        <label class="input-label"><i class="bi bi-chat-left-text"></i> Description</label>
                        <input type="text" id="edit-income-description" placeholder="Description" class="modern-input">
                        <span class="input-focus-border"></span>
                    </div>
                    <div class="input-group-modern">
                        <label class="input-label"><i class="bi bi-calendar-event"></i> Date</label>
                        <input type="date" id="edit-income-date" required class="modern-input">
                        <span class="input-focus-border"></span>
                    </div>
                    <button type="submit" class="btn-modern btn-success">
                        <i class="bi bi-check-circle-fill"></i> Update Income
                    </button>
                </form>
            </div>
        </div>

        <!-- Budget Modal - Custom Simple Modal -->
        <div id="budget-modal-overlay" class="custom-modal-overlay">
            <div class="custom-modal">
                <div class="custom-modal-header">
                    <h3><i class="bi bi-wallet2"></i> Set Monthly Budget</h3>
                    <button class="custom-modal-close" id="close-budget-modal">&times;</button>
                </div>
                <div class="custom-modal-body">
                    <form id="budget-form">
                        <div class="form-group">
                            <label>Monthly Budget Amount</label>
                            <div class="input-with-icon">
                                <span class="input-icon">₹</span>
                                <input type="number" id="budget-amount" placeholder="Enter amount" required min="0" step="100">
                            </div>
                            <small>Set your monthly spending limit</small>
                        </div>
                        
                        <div class="form-group">
                            <label>Current Month Expenses</label>
                            <div class="info-box">
                                <i class="bi bi-info-circle"></i>
                                <span id="current-month-expense-info">₹0</span>
                            </div>
                        </div>

                        <!-- Budget Alert Settings -->
                        <div class="alert-settings-section">
                            <h4><i class="bi bi-bell"></i> Alert Settings</h4>
                            
                            <div class="alert-toggle">
                                <input type="checkbox" id="alert-80-enabled" checked>
                                <label for="alert-80-enabled">
                                    <i class="bi bi-exclamation-triangle"></i>
                                    Alert at 80% budget usage
                                </label>
                            </div>
                            
                            <div class="alert-toggle">
                                <input type="checkbox" id="alert-100-enabled" checked>
                                <label for="alert-100-enabled">
                                    <i class="bi bi-x-circle"></i>
                                    Alert when budget exceeded
                                </label>
                            </div>
                            
                            <div class="form-group">
                                <label>Daily Spending Limit (Optional)</label>
                                <div class="input-with-icon">
                                    <span class="input-icon">₹</span>
                                    <input type="number" id="daily-limit" placeholder="e.g., 500" min="0" step="50">
                                </div>
                                <small>Get alert if you exceed this daily</small>
                            </div>
                            
                            <div class="alert-toggle">
                                <input type="checkbox" id="notification-sound" checked>
                                <label for="notification-sound">
                                    <i class="bi bi-volume-up"></i>
                                    Enable notification sound
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Quick Suggestions</label>
                            <div class="suggestion-grid">
                                <button type="button" class="btn-suggestion" data-amount="5000">₹5,000</button>
                                <button type="button" class="btn-suggestion" data-amount="10000">₹10,000</button>
                                <button type="button" class="btn-suggestion" data-amount="20000">₹20,000</button>
                                <button type="button" class="btn-suggestion" data-amount="50000">₹50,000</button>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn-save-budget">
                            <i class="bi bi-check-circle"></i> Save Budget & Alerts
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Budget Modal -->
        <div class="modal fade" id="budgetModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content budget-modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">
                            <i class="bi bi-wallet2"></i> Set Monthly Budget
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <form id="budget-form-old">
                            <div class="mb-3">
                                <label class="form-label">Monthly Budget Amount</label>
                                <div class="input-group">
                                    <span class="input-group-text budget-input-icon">₹</span>
                                    <input type="number" class="form-control budget-input" id="budget-amount-old" placeholder="Enter amount" required min="0" step="100">
                                </div>
                                <small class="form-text">Set your monthly spending limit</small>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label">Current Month Expenses</label>
                                <div class="budget-current-info">
                                    <i class="bi bi-info-circle"></i>
                                    <span id="current-month-expense-info-old">₹0</span>
                                </div>
                            </div>

                            <div class="budget-suggestions">
                                <label class="form-label">Quick Suggestions</label>
                                <div class="suggestion-buttons">
                                    <button type="button" class="btn-suggestion" onclick="setBudgetAmount(5000)">₹5,000</button>
                                    <button type="button" class="btn-suggestion" onclick="setBudgetAmount(10000)">₹10,000</button>
                                    <button type="button" class="btn-suggestion" onclick="setBudgetAmount(20000)">₹20,000</button>
                                    <button type="button" class="btn-suggestion" onclick="setBudgetAmount(50000)">₹50,000</button>
                                </div>
                            </div>
                            
                            <button type="submit" class="btn-save-budget">
                                <i class="bi bi-check-circle"></i> Save Budget
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
